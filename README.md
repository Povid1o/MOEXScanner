# üìä MOEX Scanner ‚Äî Volatility Forecasting System

<div align="center">

![Python](https://img.shields.io/badge/Python-3.12-3776AB?style=for-the-badge&logo=python&logoColor=white)
![LightGBM](https://img.shields.io/badge/LightGBM-4.6-9ACD32?style=for-the-badge)
![Pandas](https://img.shields.io/badge/Pandas-2.3-150458?style=for-the-badge&logo=pandas&logoColor=white)
![NumPy](https://img.shields.io/badge/NumPy-2.3-013243?style=for-the-badge&logo=numpy&logoColor=white)
![Jupyter](https://img.shields.io/badge/Jupyter-Lab-F37626?style=for-the-badge&logo=jupyter&logoColor=white)
![License](https://img.shields.io/badge/License-MIT-green?style=for-the-badge)

**–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∞–∫—Ü–∏–π –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –±–∏—Ä–∂–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è**

[–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏](#-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏) ‚Ä¢
[–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞) ‚Ä¢
[ML Pipeline](#-ml-pipeline) ‚Ä¢
[–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞) ‚Ä¢
[–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ) ‚Ä¢
[–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)

</div>

---

## üéØ –û –ø—Ä–æ–µ–∫—Ç–µ

**MOEX Scanner** ‚Äî —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∞–∫—Ü–∏–π, —Ç–æ—Ä–≥—É–µ–º—ã—Ö –Ω–∞ –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –±–∏—Ä–∂–µ. –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–≤–∞–Ω—Ç–∏–ª—å–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –±—É–¥—É—â–µ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–æ–º 5 –¥–Ω–µ–π.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîÆ **–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏** ‚Äî –∫–≤–∞–Ω—Ç–∏–ª—å–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (16%, 50%, 84%) –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏
- üìà **30 —Ç–∏–∫–µ—Ä–æ–≤ MOEX** ‚Äî –≥–æ–ª—É–±—ã–µ —Ñ–∏—à–∫–∏ –∏ –ª–∏–∫–≤–∏–¥–Ω—ã–µ –∞–∫—Ü–∏–∏ –≤—Ç–æ—Ä–æ–≥–æ —ç—à–µ–ª–æ–Ω–∞  
- üß† **–ï–¥–∏–Ω–∞—è –≥–ª–æ–±–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å** ‚Äî –æ–¥–Ω–∞ –º–æ–¥–µ–ª—å —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –≤—Å–µ—Ö —Å–µ–∫—Ç–æ—Ä–æ–≤
- üìä **–ü–æ–ª–Ω—ã–π backtesting pipeline** ‚Äî —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è —Å –∫–æ–º–∏—Å—Å–∏–µ–π –∏ slippage
- üîç **Explainability** ‚Äî SHAP-–∞–Ω–∞–ª–∏–∑ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏–π –º–æ–¥–µ–ª–∏

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
MOEXScanner/
‚îú‚îÄ‚îÄ ML/                          # üß† Machine Learning Pipeline
‚îÇ   ‚îú‚îÄ‚îÄ scripts/                 # üìú –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ run_full_pipeline.py    # –ü–æ–ª–Ω—ã–π pipeline
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validate_model.py       # –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ compare_models.py       # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ notebooks/               # üìì Jupyter –Ω–æ—É—Ç–±—É–∫–∏ (–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 01_data_loading.ipynb
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ plots.ipynb
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ 02_feature_engineering/  # üî¨ –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ 03_models/               # ü§ñ –ú–æ–¥–µ–ª–∏ (notebooks + production)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ train_global_model.py   # –û–±—É—á–µ–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ inference.py            # –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ 04_backtesting/          # üìà –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥
‚îÇ   ‚îú‚îÄ‚îÄ 05_explainability/       # üîç –û–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å
‚îÇ   ‚îú‚îÄ‚îÄ 06_utils/                # üõ†Ô∏è –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ features/                # ‚öôÔ∏è Production: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ feature_builder.py      # –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ volatility_features.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ volume_features.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ market_features.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ trend_features.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ calendar_features.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ intraday_features.py    # H1 –ø—Ä–∏–∑–Ω–∞–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Loaders/
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ models/                  # üß† Production: –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ensemble.py             # –ê–Ω—Å–∞–º–±–ª—å LightGBM + GARCH
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ config/                  # ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ training_config.py      # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è (–ì–õ–ê–í–ù–´–ô!)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tickers_metadata.json
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ data/                    # üíæ –î–∞–Ω–Ω—ã–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MOEX_DATA/              # –ò—Å—Ö–æ–¥–Ω—ã–µ OHLCV (D1 + H1)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ processed/              # –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ processed_ml/           # ML features
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ backtest/               # –î–∞–Ω–Ω—ã–µ –¥–ª—è –±—ç–∫—Ç–µ—Å—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ models/                 # –û–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ reports/                 # üìä –û—Ç—á—ë—Ç—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validation_report.csv
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ feature_importance.csv
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validation_detailed.csv
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ docs/                    # üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SYSTEM_STRUCTURE.md     # –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SYSTEM_GUIDE.md         # –ì–∞–π–¥ –ø–æ —Ä–∞–±–æ—Ç–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DEVELOPMENT_ROADMAP.md   # –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CURRENT_STATUS.md       # –ü—Ä–æ–±–ª–µ–º—ã –∏ –º–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ tools/                   # üõ†Ô∏è –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ backend/                     # üîß Backend API (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
‚îî‚îÄ‚îÄ frontend/                    # üé® Frontend UI (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
```

---

## üß† ML Pipeline

### –û–±–∑–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞

```mermaid
graph LR
    A[üì• Data Loading] --> B[üîß Feature Engineering]
    B --> C[ü§ñ Model Training]
    C --> D[üìà Backtesting]
    D --> E[üîç Explainability]
```

---

### üì• –≠—Ç–∞–ø 1: Data Loading

**–§–∞–π–ª:** `ML/01_data_loading.ipynb`

–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö OHLCV –¥–∞–Ω–Ω—ã—Ö —Å MOEX –∏ –ø–µ—Ä–≤–∏—á–Ω–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞.

| –û–ø–µ—Ä–∞—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| –ó–∞–≥—Ä—É–∑–∫–∞ CSV | –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ `MOEX_DATA/{TICKER}/1D/` |
| Log Returns | –†–∞—Å—á—ë—Ç –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏—Ö –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π: `log(P‚Çú / P‚Çú‚Çã‚ÇÅ)` |
| –û—á–∏—Å—Ç–∫–∞ | –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏ –∞–Ω–æ–º–∞–ª–∏–π |
| –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ | Parquet —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è |

**–ü–æ–∫—Ä—ã—Ç–∏–µ:** 30 —Ç–∏–∫–µ—Ä–æ–≤, –¥–Ω–µ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –æ–∫—Ç—è–±—Ä—è 2020 –≥.

<details>
<summary>üìã –°–ø–∏—Å–æ–∫ —Ç–∏–∫–µ—Ä–æ–≤</summary>

| –°–µ–∫—Ç–æ—Ä | –¢–∏–∫–µ—Ä—ã |
|--------|--------|
| **Finance** | SBER, VTBR, TCSG, BSPB |
| **Oil & Gas** | GAZP, LKOH, ROSN, NVTK, TATN, SNGS |
| **Mining** | GMKN, ALRS, PLZL |
| **Metals** | CHMF, NLMK, MAGN |
| **Tech** | YNDX, OZON, VKCO |
| **Telecom** | MTSS, RTKM |
| **Retail** | MGNT, FIVE, LENT |
| **Utilities** | HYDR, IRAO |
| **Other** | AFLT, PIKK, AFKS, BELU |

</details>

---

### üîß –≠—Ç–∞–ø 2: Feature Engineering

**–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:** `ML/features/` (production) + `ML/02_feature_engineering/` (research)

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è **~66 –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** –¥–ª—è ML-–º–æ–¥–µ–ª–∏.

#### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

<table>
<tr>
<td width="50%">

**üìä Volatility Features (D1)**
```
‚Ä¢ realized_vol_5/10/20/30/60d
‚Ä¢ ewma_vol_10/20d
‚Ä¢ parkinson_vol_10/20d
‚Ä¢ garman_klass_vol_10/20d
‚Ä¢ up_vol_20d / down_vol_20d
‚Ä¢ vol_asymmetry_20d
‚Ä¢ vol_ratio_5_20, vol_ratio_20_60
‚Ä¢ vol_momentum_5/10d
```

**üìà Trend Features**
```
‚Ä¢ dist_to_sma_20/50/200
‚Ä¢ dist_to_ema_20/50
‚Ä¢ sma_20/50_slope_norm
‚Ä¢ momentum_10/20
‚Ä¢ rsi_14
‚Ä¢ trend_signal (-1/0/1)
‚Ä¢ trend_strength
```

</td>
<td width="50%">

**üì¶ Volume Features**
```
‚Ä¢ volume_zscore_20/60
‚Ä¢ volume_ratio_20
‚Ä¢ volume_spike (binary)
‚Ä¢ vp_position (Volume Profile)
‚Ä¢ vp_width_pct
‚Ä¢ vp_above_va
```

**üìÖ Calendar Features**
```
‚Ä¢ day_of_week (0-6)
‚Ä¢ day_of_month (1-31)
‚Ä¢ week_of_month
‚Ä¢ is_month_end/start
‚Ä¢ overnight_gap
‚Ä¢ overnight_gap_zscore
```

**‚è∞ Intraday Features (H1)**
```
‚Ä¢ ivr (Intraday Vol Realized)
‚Ä¢ opm (Opening Momentum)
‚Ä¢ vds (Vol Distribution Skew)
‚Ä¢ pocs (POC Session Shift)
‚Ä¢ hvc (High Volatility Count)
‚Ä¢ irr (Intraday Range Ratio)
```

</td>
</tr>
</table>

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

> ‚ö†Ô∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ:** ML-–¥–∞—Ç–∞—Å–µ—Ç –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Ü–µ–Ω –∏ –æ–±—ä—ë–º–æ–≤!

| –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ | –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ |
|--------------|------------------------|
| `close`, `SMA_20` | `dist_to_sma_20 = close / SMA - 1` |
| `volume` | `volume_zscore = (V - MA) / STD` |
| `VP POC level` | `vp_position = (close - POC) / VA_width` |

#### –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ç–∏–∫–µ—Ä–æ–≤

–ö–∞–∂–¥—ã–π —Ç–∏–∫–µ—Ä –æ–±–æ–≥–∞—â–∞–µ—Ç—Å—è –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:

```python
{
    "ticker_id": "SBER",
    "sector_id": "Finance",
    "sector_encoded": 1,        # –ß–∏—Å–ª–æ–≤–æ–π –∫–æ–¥ —Å–µ–∫—Ç–æ—Ä–∞
    "liquidity_rank": 1,        # 1 = —Å–∞–º—ã–π –ª–∏–∫–≤–∏–¥–Ω—ã–π
    "is_blue_chip": 1,          # –ì–æ–ª—É–±–∞—è —Ñ–∏—à–∫–∞
    "lot_size_log": 2.30        # log(lot_size)
}
```

---

### ü§ñ –≠—Ç–∞–ø 3: Model Training

**–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:** `ML/03_models/`

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   GLOBAL QUANTILE MODEL                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Input: –í—Å–µ —Ç–∏–∫–µ—Ä—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ –µ–¥–∏–Ω—ã–π DataFrame            ‚îÇ
‚îÇ  ‚Üì                                                           ‚îÇ
‚îÇ  Feature Engineering: ~66 –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (D1 + H1)‚îÇ
‚îÇ  ‚Üì                                                           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îÇ
‚îÇ  ‚îÇ LightGBM    ‚îÇ  ‚îÇ LightGBM    ‚îÇ  ‚îÇ LightGBM    ‚îÇ          ‚îÇ
‚îÇ  ‚îÇ Œ± = 0.16    ‚îÇ  ‚îÇ Œ± = 0.50    ‚îÇ  ‚îÇ Œ± = 0.84    ‚îÇ          ‚îÇ
‚îÇ  ‚îÇ (Lower 1œÉ)  ‚îÇ  ‚îÇ (Median)    ‚îÇ  ‚îÇ (Upper 1œÉ)  ‚îÇ          ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ
‚îÇ         ‚îÇ                ‚îÇ                ‚îÇ                  ‚îÇ
‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ
‚îÇ                          ‚Üì                                   ‚îÇ
‚îÇ              [pred_q16, pred_q50, pred_q84]                  ‚îÇ
‚îÇ                   –ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è

```python
target_vol_5d = rolling_std(log_return, 5).shift(-5) * ‚àö252
```

> –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ 5 –¥–Ω–µ–π, —Å–º–µ—â—ë–Ω–Ω–∞—è –≤ –±—É–¥—É—â–µ–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.

#### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã LightGBM

```python
LGBM_PARAMS = {
    'boosting_type': 'gbdt',
    'objective': 'quantile',
    'num_leaves': 63,
    'learning_rate': 0.05,
    'feature_fraction': 0.8,
    'bagging_fraction': 0.8,
    'lambda_l1': 0.1,
    'lambda_l2': 0.1,
    'min_child_samples': 20
}
```

#### Train/Test Split

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2020-10  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  2025-10  ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë ‚îÇ
‚îÇ ‚îÇ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ TRAIN (–¥–æ 2024-06-01) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ‚Üê‚îÄ‚îÄ TEST ‚îÄ‚îÄ‚Üí‚îÇ   ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ –°—Ç—Ä–æ–≥–∏–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π split –±–µ–∑ shuffle!                     ‚îÇ
‚îÇ –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 70% / 30%                                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- Train: 25,528 –∑–∞–ø–∏—Å–µ–π (–¥–æ 2024-06-01)
- Test: 11,533 –∑–∞–ø–∏—Å–µ–π (–ø–æ—Å–ª–µ 2024-06-01)
- Cutoff: `2024-06-01` (–ø—Ä–µ—Å–µ—Ç MORE_TRAIN)

#### Sample Weighting

–ë–æ–ª–µ–µ –ª–∏–∫–≤–∏–¥–Ω—ã–µ –∞–∫—Ç–∏–≤—ã –ø–æ–ª—É—á–∞—é—Ç –±–æ–ª—å—à–∏–π –≤–µ—Å:

```python
weight = 1 / log(liquidity_rank + 2)
```

---

### üìà –≠—Ç–∞–ø 4: Backtesting

**–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:** `ML/04_backtesting/`

#### –¢–æ—Ä–≥–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: Mean Reversion in Trend

```python
# LONG: –í–æ—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥ + –æ—Ç–∫–∞—Ç –∫ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–µ
signal_long = (trend == 1) & (low <= lower_band)

# SHORT: –ù–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥ + —Ä–æ—Å—Ç –∫ –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–µ  
signal_short = (trend == -1) & (high >= upper_band)
```

#### –î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥–Ω–æ–∑–æ–≤

```python
upper_band = close √ó (1 + pred_q84)
lower_band = close √ó (1 - pred_q84)
take_profit = close √ó (1 + pred_q50 √ó 0.5)
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–º—É–ª—è—Ü–∏–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –ö–æ–º–∏—Å—Å–∏—è | 0.1% |
| Slippage | 0.05% |
| Stop Loss (Long) | lower_band √ó 0.98 |
| Stop Loss (Short) | upper_band √ó 1.02 |

#### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- **Sharpe Ratio** ‚Äî –≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å / –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
- **Max Drawdown** ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞
- **Win Rate** ‚Äî –¥–æ–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
- **Profit Factor** ‚Äî –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏ –∫ —É–±—ã—Ç–∫–∞–º
- **Expectancy** ‚Äî —Å—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å –Ω–∞ —Å–¥–µ–ª–∫—É

---

### üîç –≠—Ç–∞–ø 5: Explainability

**–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:** `ML/05_explainability/`

#### SHAP Analysis

–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏–π –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ SHAP values:

```python
explainer = shap.TreeExplainer(model)
shap_values = explainer.shap_values(X_test)
shap.summary_plot(shap_values, X_test)
```

#### Feature Importance (Gain)

–¢–æ–ø-10 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏ (gain):

```
parkinson_vol_10d    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  4875.4
ewma_vol_20d         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       3347.7
ticker_id            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà           2338.0
ewma_vol_10d         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                      1223.0
index_vol_30d        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                       1020.0
parkinson_vol_20d    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                          844.6
index_vol_60d        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                          833.5
gk_vol_20d           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                         799.4
gk_vol_10d           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                             577.0
dist_to_ema_20       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                             552.0
```

**–ù–∞–±–ª—é–¥–µ–Ω–∏—è:**
- –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (Parkinson, EWMA) ‚Äî –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
- `ticker_id` –Ω–∞ 3 –º–µ—Å—Ç–µ ‚Äî –º–æ–¥–µ–ª—å —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫—É —Ç–∏–∫–µ—Ä–æ–≤
- –†—ã–Ω–æ—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (index_vol) –≤–∞–∂–Ω—ã –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- H1 –ø—Ä–∏–∑–Ω–∞–∫–∏ (ivr, hvc) –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç, –Ω–æ —Å –º–µ–Ω—å—à–µ–π –≤–∞–∂–Ω–æ—Å—Ç—å—é

---

## üîß Backend

<div align="center">

![Status](https://img.shields.io/badge/Status-–í%20—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ-yellow?style=for-the-badge)

</div>

> üöß **Backend API –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ**
> 
> –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:
> - REST API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
> - WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
> - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MOEX ISS API
> - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

---

## üé® Frontend

<div align="center">

![Status](https://img.shields.io/badge/Status-–í%20—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ-yellow?style=for-the-badge)

</div>

> üöß **Frontend UI –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ**
> 
> –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:
> - Dashboard —Å –æ–±–∑–æ—Ä–æ–º —Ä—ã–Ω–∫–∞
> - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
> - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
> - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Ä—Ç—Ñ–µ–ª—è

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.12+
- Windows / Linux / macOS

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/your-username/MOEXScanner.git
cd MOEXScanner/ML

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv

# 3. –ê–∫—Ç–∏–≤–∞—Ü–∏—è (Windows PowerShell)
.\venv\Scripts\Activate.ps1

# 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
python test_setup.py
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```
pandas>=2.0.0
numpy>=1.24.0
scikit-learn>=1.3.0
lightgbm>=4.0.0
matplotlib>=3.7.0
seaborn>=0.12.0
jupyter>=1.0.0
pyarrow>=12.0.0
```

<details>
<summary>–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏</summary>

```
arch>=6.0.0        # –î–ª—è GARCH –º–æ–¥–µ–ª–µ–π
shap>=0.42.0       # –î–ª—è SHAP –∞–Ω–∞–ª–∏–∑–∞
requests>=2.28.0   # –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å MOEX
```

</details>

---

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ pipeline

```powershell
cd ML
venv\Scripts\activate

# –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª: Features ‚Üí Training ‚Üí Inference
python scripts/run_full_pipeline.py

# –¢–æ–ª—å–∫–æ –æ–±—É—á–µ–Ω–∏–µ (features –≥–æ—Ç–æ–≤—ã)
python scripts/run_full_pipeline.py --skip-features --preset MORE_TRAIN

# –¢–æ–ª—å–∫–æ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å
python scripts/run_full_pipeline.py --skip-features --skip-training --ticker SBER
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏

```powershell
python scripts/validate_model.py
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

```powershell
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –æ—Ç—á—ë—Ç
copy reports\validation_report.csv reports\validation_report_baseline.csv

# –û–±—É—á–∏—Ç–µ –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å
python scripts/run_full_pipeline.py --skip-features --preset REGULARIZED

# –°—Ä–∞–≤–Ω–∏—Ç–µ
python scripts/compare_models.py
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞

```python
from inference import GlobalQuantileModel

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
model = GlobalQuantileModel(use_ensemble=True)
model.load_models()

# –ü—Ä–æ–≥–Ω–æ–∑
predictions = model.predict_ensemble(new_data)
# predictions: ['pred_q16', 'pred_q50', 'pred_q84', 'interval_width', ...]
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ **–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ**: `ML/config/training_config.py`

```python
# –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ—Å–µ—Ç –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
ACTIVE_PRESET = 'MORE_TRAIN'  # –∏–ª–∏ BASELINE, REGULARIZED, NO_TICKER

# –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞–ø—Ä—è–º—É—é:
TRAIN_CUTOFF_DATE = '2024-06-01'
LGBM_PARAMS = {
    'num_leaves': 63,
    'learning_rate': 0.05,
    'lambda_l1': 0.5,  # –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
    ...
}
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –î–æ–∫—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| [ML/docs/README.md](ML/docs/README.md) | –ì–ª–∞–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| [ML/docs/SYSTEM_STRUCTURE.md](ML/docs/SYSTEM_STRUCTURE.md) | –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã |
| [ML/docs/SYSTEM_GUIDE.md](ML/docs/SYSTEM_GUIDE.md) | –ì–∞–π–¥ –ø–æ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã |
| [ML/docs/DEVELOPMENT_ROADMAP.md](ML/docs/DEVELOPMENT_ROADMAP.md) | –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| [ML/docs/CURRENT_STATUS.md](ML/docs/CURRENT_STATUS.md) | –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –º–µ—Ç—Ä–∏–∫–∏ |
| [ML/scripts/README.md](ML/scripts/README.md) | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ |

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –º–µ—Ç—Ä–∏–∫–∏

<div align="center">

![Last Updated](https://img.shields.io/badge/Last%20Updated-2025--12--06-blue?style=for-the-badge)
![Model Version](https://img.shields.io/badge/Model-MORE_TRAIN-green?style=for-the-badge)

</div>

### –ü–æ–∫—Ä—ã—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –¢–∏–∫–µ—Ä–æ–≤ | 30 |
| –ü–µ—Ä–∏–æ–¥ | –û–∫—Ç—è–±—Ä—å 2020 ‚Äî –î–µ–∫–∞–±—Ä—å 2025 |
| –¢–∞–π–º—Ñ—Ä–µ–π–º | Daily (1D) + Hourly (1H) |
| –ó–∞–ø–∏—Å–µ–π | ~1,300 –Ω–∞ —Ç–∏–∫–µ—Ä (D1) |
| –ü—Ä–∏–∑–Ω–∞–∫–æ–≤ | **66** (D1 + H1) |

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** MORE_TRAIN (70/30 split, cutoff: 2024-06-01)

#### –ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –¶–µ–ª—å |
|---------|----------|--------|------|
| **Coverage 68%** | 66.0% | ‚úÖ | 68% ¬± 2% |
| **Interval Width** | 0.270 | ‚ö†Ô∏è | < 0.25 |
| **MAE (Median)** | 0.120 | ‚ö†Ô∏è | < 0.10 |
| **Quantile Loss (q16)** | 0.029 | ‚úÖ | < 0.03 |
| **Quantile Loss (q50)** | 0.060 | ‚ö†Ô∏è | < 0.05 |
| **Quantile Loss (q84)** | 0.049 | ‚úÖ | < 0.05 |

**Train/Test Split:**
- Train: 25,528 –∑–∞–ø–∏—Å–µ–π (70%)
- Test: 11,533 –∑–∞–ø–∏—Å–µ–π (30%)

#### –ú–µ—Ç—Ä–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö)

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|----------|--------|
| **Correlation** | 0.489 | ‚ùå –ù–∏–∑–∫–∞—è |
| **MAE** | 0.117 | ‚ö†Ô∏è –°—Ä–µ–¥–Ω–µ |
| **RMSE** | 0.280 | ‚ö†Ô∏è –í—ã—Å–æ–∫–∞—è |
| **MAPE** | 48.8% | ‚ùå –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è |
| **Bias** | +4.14% | ‚ö†Ô∏è –ó–∞–≤—ã—à–∞–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑—ã |

**–ü–æ–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞:**
- –û–∂–∏–¥–∞–µ–º–æ–µ: 68.0%
- –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ: 68.3%
- –û—à–∏–±–∫–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏: **0.3%** ‚úÖ

#### –õ—É—á—à–∏–µ —Ç–∏–∫–µ—Ä—ã (–ø–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏)

| –¢–∏–∫–µ—Ä | Coverage | MAE | Correlation |
|-------|----------|-----|-------------|
| **SBER** | 66.1% | 0.095 | **0.659** |
| **AFLT** | 69.6% | 0.118 | **0.648** |
| **LKOH** | 68.4% | 0.091 | **0.640** |
| **MTSS** | 70.9% | 0.100 | **0.638** |
| **OZON** | 68.3% | 0.164 | **0.632** |

#### –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ç–∏–∫–µ—Ä—ã

| –¢–∏–∫–µ—Ä | Correlation | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|-------|-------------|--------------|
| FIVE | 0.077 | –ò—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –æ–±—É—á–µ–Ω–∏—è |
| BELU | 0.241 | –ò—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –æ–±—É—á–µ–Ω–∏—è |
| YNDX | 0.343 | –ò—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –æ–±—É—á–µ–Ω–∏—è |
| LENT | 0.427 | –ò—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –æ–±—É—á–µ–Ω–∏—è |

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** [ML/docs/CURRENT_STATUS.md](ML/docs/CURRENT_STATUS.md)

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

<div align="center">

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
|-----------|------------|
| **ML Framework** | LightGBM, scikit-learn |
| **Data Processing** | Pandas, NumPy, PyArrow |
| **Visualization** | Matplotlib, Seaborn |
| **Development** | Jupyter Lab, VS Code |
| **Time Series** | arch (GARCH) |
| **Explainability** | SHAP |

</div>

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –°–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

---

## ü§ù –ö–æ–Ω—Ç—Ä–∏–±—å—é—Ü–∏—è

Contributions –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞:

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏–π (`git commit -m 'Add AmazingFeature'`)
4. Push –≤ branch (`git push origin feature/AmazingFeature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

---

<div align="center">

**‚≠ê –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!**

Made with ‚ù§Ô∏è for MOEX traders

</div>
