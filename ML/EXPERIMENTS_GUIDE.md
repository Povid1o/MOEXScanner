# üß™ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º —Å –º–æ–¥–µ–ª—å—é

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –±–∞—Ç–Ω–∏–∫ (Windows)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ù–û–í–û–ï –æ–∫–Ω–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞** (—á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–≤–æ–¥ —Å—Ç–∞—Ä–æ–π –º–æ–¥–µ–ª–∏)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:
   ```cmd
   cd E:\Python\VolatilityChecker\MOEXScanner\ML
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç:
   ```cmd
   run_experiment.bat MORE_TRAIN
   ```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Python –Ω–∞–ø—Ä—è–º—É—é

1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤–æ–µ –æ–∫–Ω–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
2. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
   ```cmd
   cd E:\Python\VolatilityChecker\MOEXScanner\ML
   venv\Scripts\activate
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç:
   ```cmd
   python run_experiment.py --preset MORE_TRAIN --skip-features
   ```

---

## üéõÔ∏è –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç—ã

| –ü—Ä–µ—Å–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|--------|----------|-----------|
| **BASELINE** | –¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å (60/40) | `cutoff='2024-01-01'` |
| **MORE_TRAIN** | –ë–æ–ª—å—à–µ train –¥–∞–Ω–Ω—ã—Ö (70/30) | `cutoff='2024-06-01'` |
| **REGULARIZED** | –°–∏–ª—å–Ω–∞—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è | `lambda_l1=0.5, lambda_l2=1.0, num_leaves=31` |
| **NO_TICKER** | –ë–µ–∑ ticker_id | –£–±—Ä–∞—Ç—å `ticker_id` –∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ |

---

## üìù –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –°–ø–æ—Å–æ–± 1: –í—ã–±—Ä–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –ø—Ä–µ—Å–µ—Ç

–û—Ç–∫—Ä–æ–π—Ç–µ `config/training_config.py` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ:
```python
ACTIVE_PRESET = 'MORE_TRAIN'  # –∏–ª–∏ REGULARIZED, NO_TICKER
```

### –°–ø–æ—Å–æ–± 2: –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞–ø—Ä—è–º—É—é

–í `config/training_config.py` –∏–∑–º–µ–Ω–∏—Ç–µ:
```python
# Train/Test Split
TRAIN_CUTOFF_DATE = '2024-06-01'  # –î–ª—è 70/30

# –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
LGBM_PARAMS = {
    'num_leaves': 63,
    'learning_rate': 0.05,
    'lambda_l1': 0.5,   # –£–≤–µ–ª–∏—á–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é
    'lambda_l2': 1.0,
    'min_child_samples': 50,
    ...
}
```

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

### –®–∞–≥ 1: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π `validation_report.csv`:
```cmd
copy reports\validation_report.csv reports\validation_report_baseline.csv
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç

–í **–Ω–æ–≤–æ–º –æ–∫–Ω–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞**:
```cmd
cd E:\Python\VolatilityChecker\MOEXScanner\ML
run_experiment.bat MORE_TRAIN
```

–ò–ª–∏:
```cmd
python run_experiment.py --preset MORE_TRAIN --skip-features
```

### –®–∞–≥ 3: –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –∑–∞–π–º—ë—Ç ~1-2 –º–∏–Ω—É—Ç—ã. –í—ã —É–≤–∏–¥–∏—Ç–µ:
- ‚úÖ –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
- ‚úÖ Feature importance
- ‚úÖ Validation report

### –®–∞–≥ 4: –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

```cmd
python compare_models.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å—Ä–∞–≤–Ω–∏—Ç –≤—Å–µ `validation_report*.csv` –≤ –ø–∞–ø–∫–µ `reports/`.

---

## üìä –ß—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è

| –ú–µ—Ç—Ä–∏–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –õ—É—á—à–µ |
|---------|----------|-------|
| **coverage_68** | –ü–æ–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ [q16, q84] | –ë–ª–∏–∂–µ –∫ 68% |
| **mae_median** | –°—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ | –ú–µ–Ω—å—à–µ |
| **interval_width** | –®–∏—Ä–∏–Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏ |
| **quantile_loss_*** | –ü–æ—Ç–µ—Ä–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–≤–∞–Ω—Ç–∏–ª—è | –ú–µ–Ω—å—à–µ |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 1: –ë–æ–ª—å—à–µ train –¥–∞–Ω–Ω—ã—Ö (70/30)
```cmd
python run_experiment.py --preset MORE_TRAIN --skip-features
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** –ú–µ–Ω—å—à–µ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 2: –°–∏–ª—å–Ω–∞—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
```cmd
python run_experiment.py --preset REGULARIZED --skip-features
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** –ú–µ–Ω—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è, —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –Ω–∞ test

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 3: –ë–µ–∑ ticker_id
```cmd
python run_experiment.py --preset NO_TICKER --skip-features
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** –õ—É—á—à–∞—è –≥–µ–Ω–µ—Ä–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –Ω–æ–≤—ã–µ —Ç–∏–∫–µ—Ä—ã

---

## üîç –ì–¥–µ –Ω–∞–π—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `data/models/global_lgbm_q*.txt` | –û–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ |
| `reports/validation_report.csv` | –û—Ç—á—ë—Ç –æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ |
| `reports/feature_importance.csv` | –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ |
| `reports/feature_importance.png` | –ì—Ä–∞—Ñ–∏–∫ –≤–∞–∂–Ω–æ—Å—Ç–∏ |

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--skip-features`** ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ —É–∂–µ –≥–æ—Ç–æ–≤—ã, –Ω–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å
2. **–û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤–æ–µ –æ–∫–Ω–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞** ‚Äî —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–≤–æ–¥ —Å—Ç–∞—Ä–æ–π –º–æ–¥–µ–ª–∏
3. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Å—Ç–∞—Ä—ã–µ –æ—Ç—á—ë—Ç—ã** ‚Äî –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ `validation_report.csv` –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–º
4. **–û–¥–Ω–∞ –º–æ–¥–µ–ª—å –∑–∞ —Ä–∞–∑** ‚Äî –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç —Å—Ç–∞—Ä—ã–µ –≤ `data/models/`

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "–ú–æ–¥–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
```cmd
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ features –≥–æ—Ç–æ–≤—ã:
python run_full_pipeline.py --skip-training
```

### –û—à–∏–±–∫–∞: "Config –Ω–µ –Ω–∞–π–¥–µ–Ω"
```cmd
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞:
dir config\training_config.py
```

### –ú–æ–¥–µ–ª—å –Ω–µ —É–ª—É—á—à–∏–ª–∞—Å—å
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –ø—Ä–µ—Å–µ—Ç
- –£–≤–µ–ª–∏—á—å—Ç–µ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é
- –ò—Å–∫–ª—é—á–∏—Ç–µ –ø–ª–æ—Ö–∏–µ —Ç–∏–∫–µ—Ä—ã: `EXCLUDE_TICKERS = ['FIVE', 'BELU']`

---

## üìû –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å

- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: `config/training_config.py`
- –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è: `03_models/train_global_model.py`
- –í–∞–ª–∏–¥–∞—Ü–∏—è: `python validate_model.py`

