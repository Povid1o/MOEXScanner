# üó∫Ô∏è –†–æ—É–¥–º–∞–ø —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–í–µ—Ä—Å–∏—è:** 2.0  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-12-06  
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç–∏–≤–Ω—ã–π

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å |
|-----------|--------|------------|
| **D1 Features** | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | 95% |
| **H1 Features** | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | 60% (–º–æ–¥—É–ª—å –µ—Å—Ç—å, –Ω–æ –Ω–µ –≤—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏) |
| **Model Training** | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | 100% |
| **Inference** | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | 100% |
| **Ensemble** | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | 100% |
| **Validation** | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | 100% |
| **Backtesting** | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | 100% |

**–û–±—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** ~85%

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏

### üî¥ –ö–†–ò–¢–ò–ß–ù–û (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

#### 1. –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∏–∑–∫–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (0.49), –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (0.59 ‚Üí 0.27)

**–ó–∞–¥–∞—á–∏:**
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å rolling retraining (–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ —Å–∫–æ–ª—å–∑—è—â–µ–º –æ–∫–Ω–µ)
- [ ] –£–ª—É—á—à–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- [ ] –ò—Å–∫–ª—é—á–∏—Ç—å –ø–ª–æ—Ö–∏–µ —Ç–∏–∫–µ—Ä—ã (FIVE, BELU, YNDX, LENT) –∏–∑ –æ–±—É—á–µ–Ω–∏—è
- [ ] –£–º–µ–Ω—å—à–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ `ticker_id` (—É–≤–µ–ª–∏—á–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é –∏–ª–∏ —É–±—Ä–∞—Ç—å)

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è > 0.6, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–°—Ä–æ–∫:** 2-3 –¥–Ω—è

---

#### 2. –î–æ—Ä–∞–±–æ—Ç–∫–∞ H1 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–¥—É–ª—å `intraday_features.py` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –≤—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã

**–ó–∞–¥–∞—á–∏:**
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ 5 –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ (IVR, OPM, VDS, PRC, POCS)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `feature_builder.py` —Å –æ–ø—Ü–∏–µ–π `include_intraday`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** +5-10% –∫ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤

**–°—Ä–æ–∫:** 3-5 –¥–Ω–µ–π

---

### üü° –í–ê–ñ–ù–û (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

#### 3. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ rolling retraining (—Ä–∞–∑ –≤ –º–µ—Å—è—Ü)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π –º–æ–¥–µ–ª–µ–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏

**–°—Ä–æ–∫:** 2-3 –¥–Ω—è

---

#### 4. –£–ª—É—á—à–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ó–∞–¥–∞—á–∏:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ vs —Ñ–∞–∫—Ç
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ –ø–æ —Ç–∏–ø–∞–º (over/under prediction)
- [ ] –°–æ–∑–¥–∞—Ç—å dashboard —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏

**–°—Ä–æ–∫:** 2-3 –¥–Ω—è

---

### üü¢ –ñ–ï–õ–ê–¢–ï–õ–¨–ù–û (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

#### 5. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏

**–ó–∞–¥–∞—á–∏:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å `directional_volatility` (up_vol, down_vol) –∏–∑ notebook
- [ ] –î–æ–±–∞–≤–∏—Ç—å –¥–ª–∏–Ω–Ω—ã–µ –æ–∫–Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (30d, 60d)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–∞–∫—Ä–æ-–ø—Ä–∏–∑–Ω–∞–∫–∏ (—Å—Ç–∞–≤–∫–∞ –¶–ë, —Å–∞–Ω–∫—Ü–∏–∏)

**–°—Ä–æ–∫:** 3-5 –¥–Ω–µ–π

---

#### 6. API –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å REST API –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å backend (Go)
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

**–°—Ä–æ–∫:** 5-7 –¥–Ω–µ–π

---

## üìã –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω

### –§–ê–ó–ê 1: –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ (–ö–†–ò–¢–ò–ß–ù–û)

#### –ó–∞–¥–∞—á–∞ 1.1: Rolling Retraining

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤ `train_global_model.py`:
   ```python
   def get_rolling_window(today: datetime, window_days: int = 1095) -> Tuple[str, str]:
       """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç train_start –∏ train_end –¥–ª—è —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ –æ–∫–Ω–∞."""
       train_end = today - timedelta(days=30)  # –û—Å—Ç–∞–≤–ª—è–µ–º 30 –¥–Ω–µ–π –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é
       train_start = train_end - timedelta(days=window_days)
       return train_start.strftime('%Y-%m-%d'), train_end.strftime('%Y-%m-%d')
   ```

2. –û–±–Ω–æ–≤–∏—Ç—å `config/training_config.py`:
   ```python
   USE_ROLLING_WINDOW = True
   ROLLING_WINDOW_DAYS = 1095  # 3 –≥–æ–¥–∞
   ```

3. –û–±–Ω–æ–≤–∏—Ç—å `train_global_model.py` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è rolling window

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –ú–æ–¥–µ–ª—å –±—É–¥–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ —Ç–µ–∫—É—â–∏–º —É—Å–ª–æ–≤–∏—è–º —Ä—ã–Ω–∫–∞

---

#### –ó–∞–¥–∞—á–∞ 1.2: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø–ª–æ—Ö–∏—Ö —Ç–∏–∫–µ—Ä–æ–≤

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –û–±–Ω–æ–≤–∏—Ç—å `config/training_config.py`:
   ```python
   EXCLUDE_TICKERS = ['FIVE', 'BELU', 'YNDX', 'LENT']  # r < 0.45
   ```

2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `train_global_model.py` —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —ç—Ç–∏ —Ç–∏–∫–µ—Ä—ã

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏

---

#### –ó–∞–¥–∞—á–∞ 1.3: –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–ª–∏—è–Ω–∏—è ticker_id

**–í–∞—Ä–∏–∞–Ω—Ç A:** –£–≤–µ–ª–∏—á–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é
```python
LGBM_PARAMS = {
    'lambda_l1': 0.5,  # –ë—ã–ª–æ 0.1
    'lambda_l2': 1.0,  # –ë—ã–ª–æ 0.1
    ...
}
```

**–í–∞—Ä–∏–∞–Ω—Ç B:** –£–±—Ä–∞—Ç—å ticker_id –∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
```python
CATEGORICAL_FEATURES = [
    # 'ticker_id',  # –£–±—Ä–∞—Ç—å
    'sector_id',
    ...
]
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –õ—É—á—à–∞—è –≥–µ–Ω–µ—Ä–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –Ω–æ–≤—ã–µ —Ç–∏–∫–µ—Ä—ã

---

### –§–ê–ó–ê 2: –î–æ—Ä–∞–±–æ—Ç–∫–∞ H1 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

#### –ó–∞–¥–∞—á–∞ 2.1: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏

**–§–∞–π–ª:** `features/intraday_features.py`

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
def ivr(hourly_returns: pd.Series) -> float:
    """Intraday Volatility Realized."""
    return hourly_returns.std() * np.sqrt(252 * 7)

def opm(open_price: float, close_10am: float) -> float:
    """Opening Momentum (–ø–µ—Ä–≤—ã–π —á–∞—Å)."""
    return (close_10am - open_price) / open_price

def vds(hourly_returns: pd.Series) -> float:
    """Vol Distribution Skew."""
    return hourly_returns.skew()

def prc(hourly_returns: pd.Series) -> int:
    """Price Reversal Count."""
    signs = np.sign(hourly_returns)
    return (signs != signs.shift()).sum()

def pocs(hourly_poc: pd.Series, atr: float) -> float:
    """POC Shift Intraday."""
    return (hourly_poc.iloc[-1] - hourly_poc.iloc[0]) / atr
```

---

#### –ó–∞–¥–∞—á–∞ 2.2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ feature_builder

**–§–∞–π–ª:** `features/feature_builder.py`

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# –í build_all_features():
if include_intraday and hourly_df is not None:
    print(f"    ‚Ä¢ –í–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω—ã–µ —Ñ–∏—á–∏ (H1)...")
    intraday_features = build_intraday_features(hourly_df)
    features_to_concat.append(intraday_features)
```

---

### –§–ê–ó–ê 3: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

#### –ó–∞–¥–∞—á–∞ 3.1: –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

**–§–∞–π–ª:** `scripts/retrain_model.py`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è (—Ä–∞–∑ –≤ –º–µ—Å—è—Ü)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ rolling window
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π –º–æ–¥–µ–ª–µ–π
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### –¢–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (2025-12-06)

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –¶–µ–ª—å |
|---------|----------|------|
| **Coverage 68%** | 66.0% | 68% ¬± 2% |
| **MAE** | 0.120 | < 0.10 |
| **Correlation** | 0.489 | > 0.60 |
| **Correlation (—Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ)** | 0.590 | > 0.60 |
| **Correlation (–Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)** | 0.274 | > 0.50 |
| **Bias** | +4.14% | < 2% |

### –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–ø–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π)

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–µ–∫—É—â–µ–µ | –¶–µ–ª—å |
|---------|---------|------|
| **Correlation** | 0.489 | > 0.60 |
| **Correlation (–Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)** | 0.274 | > 0.50 |
| **Bias** | +4.14% | < 2% |
| **Coverage** | 66.0% | 68% ¬± 1% |

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### Workflow –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–∏—á

1. **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ** ‚Üí Notebook –≤ `02_feature_engineering/`
2. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è** ‚Üí Production –º–æ–¥—É–ª—å –≤ `features/`
3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Üí –î–æ–±–∞–≤–∏—Ç—å –≤ `feature_builder.py`
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å `scripts/run_full_pipeline.py`
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å `scripts/validate_model.py`
6. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ** ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å `scripts/compare_models.py`

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [SYSTEM_STRUCTURE.md](SYSTEM_STRUCTURE.md) - –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- [SYSTEM_GUIDE.md](SYSTEM_GUIDE.md) - –ì–∞–π–¥ –ø–æ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã
- [CURRENT_STATUS.md](CURRENT_STATUS.md) - –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –º–µ—Ç—Ä–∏–∫–∏
